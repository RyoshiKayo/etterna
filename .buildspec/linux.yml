version: 0.2

phases:
  install:
    commands:
      - apt-get update && apt-get upgrade -y
      - >
        apt-get install -y
        nasm
        libudev-dev
        gcc-5
        g++-5
        libmad0-dev
        libgtk2.0-dev
        binutils-dev
        libasound-dev
        libpulse-dev
        libjack-dev
        libc6-dev
        libogg-dev
        libvorbis-dev
        libxtst-dev
        libxrandr-dev
        libglew-dev
        libuv-dev
        clang-format-5.0
        libcurl4-openssl-dev
      - curl -LO --silent https://github.com/Kitware/CMake/releases/download/v3.14.0/cmake-3.14.0-Linux-x86_64.sh
      - sh cmake-3.14.0-Linux-x86_64.sh --prefix=/usr/local/ --exclude-subdir --skip-license
  pre_build:
    commands:
      - mkdir -p $CODEBUILD_SRC_DIR/build
      - cd $CODEBUILD_SRC_DIR/build
      - cmake ..
  build:
    commands:
      - make -j 4
